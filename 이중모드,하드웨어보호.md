## 이중모드

- 한 컴퓨터를 여러 사람이 동시에 사용하는 환경
  - 또는 한 사람이 여러 개의 프로그램을 동시에 사용
  - 한 사람의 고의/실수 프로그램이 전체 영향
    - STOP, HALT, RESET 등
- 사용자 프로그램은 STOP 등 치명적 명령 사용 불가하게!
  - 사용자 (user) 모드 vs 관리자 (supervisor) 모드
  - 이중 모드 (dual mode)
  - 관리자 모드 = 시스템 모드 = 모니터 모드 = 특권 모드
  - Supervisor, system, monitor, priviliged mode
- 특권 명령 (privileged instructions)
  - STOP, HALT, RESET, SET_TIMER, SET_HW, …

## 이중모드

- 이중 모드 (dual mode)

  - 레지스터(CPU안에 있음)에 모드를 나타내는 플래그(flag)

    ```
    resister : bit들의 모음(32bit, 64bit)

    이중모드를 나타내는 bit를 resister에 추가하여 플래그로 사용
    ```

  - 운영체제 서비스 실행될 때는 관리자 모드
  - 사용자 프로그램 실행될 때는 사용자 모드
  - 하드웨어/소프트웨어 인터럽트 발생하면 관리자 모드
  - 운영체제 서비스(ISR)가 끝나면 다시 사용자 모드

- 일반적 프로그램의 실행
  - 프로그램 적재 (on memory)
  - User mode > (키보드, 마우스) > system mode (ISR) > user
    mode > (모니터, 디스크, 프린터) > system mode > user mode
  - 그림 참조

## 하드웨어 보호

- 입출력장치 보호
  - Input/output device protection
- 메모리 보호
  - Memory protection
- CPU 보호
  - CPU protectiopn

## (1) 입출력장치 보호

- 사용자의 잘못된 입출력 명령
  - 다른 사용자의 입출력, 정보 등에 방해
  - 예: 프린트 혼선, 리셋 등
  - 예: 다른 사람의 파일 읽고 쓰기 (하드디스크)
- 해결법
  - 입출력 명령을 특권명령으로: IN, OUT
  - 입출력을 하려면 운영체제에게 요청하고 (system mode 전환),
  - 운영체제가 입출력 대행; 마친 후 다시 user mode 복귀
  - 올바른 요청이 아니면 운영체제가 거부
- 사용자가 입출력 명령을 직접 내린 경우?
  - Privileged instruction violation -> 프로그램 가엦 종료
